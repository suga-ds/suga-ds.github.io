<!-- public/index.html -->
<!DOCTYPE html>
<html>

<head>
    <title>dexifra</title>
    <link rel="icon" href="/images/logo.png" type="image/png">
    <meta charset="UTF-8">
    <link href='./landingPageStyle.css' rel='stylesheet'>
    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
    <script src="https://cdn.maptiler.com/maptiler-sdk-js/v2.0.3/maptiler-sdk.umd.js"></script>
    <link href="https://cdn.maptiler.com/maptiler-sdk-js/v2.0.3/maptiler-sdk.css" rel="stylesheet" />
    <script src="https://cdn.maptiler.com/leaflet-maptilersdk/v2.0.0/leaflet-maptilersdk.js"></script>
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;700&display=swap" rel="stylesheet">
    <!-- Mobile sizing -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
</head>

<body>

    <div class="heroSection">
        
        <!-- HEADER -->
        <div class="header">
            <div class="logoName">
                <!-- <img src="./images/logo.png" alt="Logo" style="width: 1.5rem; height: 1.5rem;"> -->
                <p style="margin: 0; font-size: 2vh;">dexifra</p>
            </div>
            <div class="navigation">
                <!-- <div id="queOferim">
                    <p><a style="text-decoration: none; color: inherit;">Què oferim</a></p>
                </div> -->
                <div class="buttonNav">
                    <div><a>CONTACTA'M</a></div>
                </div>
            </div>
        </div>
        <!-- HEADER END -->

    
        <h1>MAPES INTERACTIUS<br><span class=" highlight">PEL WEB</span></h1>
        <p>Faig mapes interactius customitzats per aquells que volen<br> portar l'experiencia dels seus usuaris un pas més enllà</p>
        <div class="button">
            <div><a>CONTACTA'M</a></div>
        </div>
        <div class="choroplethMap">
            <div id="choroplethMap"></div>
        </div>
    </div>

    <div id="serviceSection">
        <div id="sectinTitle">
            <h1 style="display: flex; justify-content: center; margin-bottom: 3vw; font-size: 4vh;">Mapes dissenyats per captivar</h1>
        </div>
        <div class="blocks">
            <div class="block">
                <img src="./images/webNative2.png" alt="database" style="height: 10vh;">
                <h2>Implentats al web</h2>
                <p>El mapa carrega dinàmicament la informació geogràfica a mesura que l'usuari s'apropa, fa clic o passa el ratolí per sobre dels elements de la pàgina. Oferim una interfície que sigui fàcil de navegar.</p>
            </div>
            <div class="block">
                <img src="./images/mobileFriendly2.png" alt="database" style="height: 10vh;">
                <h2>Mobile-Friendly</h2>
                <p>Els mapes de 'dexifra' estan suportats pels buscadors web a l'ordinador i al mòbil. És un recurs universal que permet que l'usuari interaccioni amb el mapa des de tota mena de dispositius.</p>
            </div>
            <div class="block">
                <img src="./images/realTimeUpdates2.png" alt="database" style="height: 10vh;">
                <h2>Actualizats en temps real</h2>
                <p>Quan les dades que sustenten el mapa s'actualitzen, el mateix mapa es renova automàticament per reflectir aquests canvis. D'aquesta manera, es poden fer canvis recurrents en les bases de dades sense modificar la tecnologia dels mapes.</p>
            </div>
        </div>
        <div id="plottedMap"></div>
    </div>
      
    <div style="background-color: #333; padding: 4vh 10vw; color: rgb(248, 248, 248);">
        <h1 style="display: flex; justify-content: center; text-align: center; margin: 4vh;">Comencem un projecte cartogràfic!</h1>
        <form action="" method="get" style="line-height: 5vh;">
            <div style="display: flex;justify-content: center; gap: 1vw;" class="formSet">
                <div>
                    <label for="name">NAME*</label><br>
                    <input type="text" name="name" id="name" required placeholder="Name"/>
                </div>
                <div>
                    <label for="name">EMAIL*</label><br>
                    <input type="text" name="name" id="name" required placeholder="Email"/>
                </div>
            </div>
            <div style="display: flex; justify-content: center;">
                <div>
                    <label for="name">MESSAGE*</label><br>
                    <input type="text" name="name" id="name" required style="width: 41vw; height: 10vw; border-radius: 0.5vh;" placeholder="Comenta'ns coses del projecte: Ideés, objectius o exemples."/>
                </div>
            </div>
            <div style="display: flex; justify-content: center;"><p><input style="justify-content: center; width: 41vw; height: 6vh;" type="submit" value="Enviar missatge (contestaré!)"></p></div>
        </form>
    </div>

    <script>
        // Initialize the choropleth map map
        const map2 = L.map('choroplethMap').setView([41.3851, 2.1734], 12); // Centered on Barcelona
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
        }).addTo(map2);

        // Initialize the plotted map map
        const map3 = L.map('plottedMap').setView([41.3851, 2.1734], 12); // Centered on Barcelona
        L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png', {
        }).addTo(map3);

        // Fetch and display the districtes data
        fetch('./cartography/barcelonaDistrictes.geojson')
            .then(response => response.json())
            .then(data => {
                L.geoJSON(data, {
                    style: {
                        color: "#000",
                        // fillColor: "#3867A8",
                        weight: 1,
                        opacity: 0.2,
                        fillOpacity: 0
                    },
                    onEachFeature: function (feature, layer) {
                        if (feature.properties && feature.properties.name) {
                            layer.bindPopup(feature.properties.name);
                        }
                    }
                }).addTo(map3);
            })
            .catch(error => console.error('Error fetching districts data:', error));

        fetch('./cartography/barcelonaBarris.json')
            .then(response => response.json())
            .then(data => {
                // Loop through the records in the JSON file
                data.result.records.forEach(function (record) {
                    // Parse the WGS84 geometry
                    var wgs84Coordinates = record.geometria_wgs84
                        .replace('POLYGON ((', '')
                        .replace('))', '')
                        .split(', ')
                        .map(coord => coord.split(' ').map(Number));

                    // Create an array of LatLng objects
                    var latLngs = wgs84Coordinates.map(coord => [coord[1], coord[0]]);

                    // Define style options
                    var polygonStyle = {
                        color: "#000",
                        // fillColor: "#3867A8",
                        weight: 1,
                        opacity: 0.1,
                        fillOpacity: 0
                    };

                    // Add the polygon to map1
                    L.polygon(latLngs, polygonStyle).addTo(map1);
                    // Add the polygon to map3
                    L.polygon(latLngs, polygonStyle).addTo(map3);
                });
            })
            .catch(error => console.error('Error fetching the JSON data:', error));
    </script>
    <script type="text/javascript" src="./cartography/densitatPoblació.js"></script>
    <script src="./cartography/mainDensitatPoblacio.js"></script>
    <script src="./cartography/mainRefugisClimàtics.js"></script>
    <script>
        document.getElementById("scrollToSection1").addEventListener("click", function () {
            document.getElementById("section1").scrollIntoView({ behavior: 'smooth' });
        });
        document.getElementById("scrollToSection2").addEventListener("click", function () {
            document.getElementById("section1").scrollIntoView({ behavior: 'smooth' });
        });
    </script>
</body>

</html>